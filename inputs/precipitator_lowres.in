<comment>
problem   = Precipitator box

<job>
problem_id = precipitator   # problem ID: basename of output filenames

<parthenon/output1>
file_type  = hst       # History data dump
dt         = 50.0       # time increment between outputs

<parthenon/output2>
file_type  = hdf5      # HDF5 data dump
variables  = prim, drho_over_rho, dP_over_P, dK_over_K, dT_over_T, entropy, temperature, tcool_over_tff, dv_x, dv_y, dv_z, accel_x, accel_y, accel_z
dt         = 50.0        # Time increment between outputs
id         = prim      # Name to append to output

<parthenon/output3>
file_type  = rst        # Binary data dump
dt         = 250.0        # time increment between outputs
id         = restart

<parthenon/time>
cfl        = 0.2        # The Courant, Friedrichs, & Lewy (CFL) Number
nlim       = -1         # cycle limit
tlim       = 1.0e4      # time limit
integrator  = rk2       # time integration algorithm
perf_cycle_offset  = 10 # interval for stdout summary info


<parthenon/mesh>
refinement  = static
nghost = 4

nx1        = 64       # Number of zones in X1-direction
x1min      = -50.       # minimum value of X1
x1max      = 50.0       # maximum value of X1
ix1_bc     = periodic   # inner-X1 boundary flag
ox1_bc     = periodic   # outer-X1 boundary flag

nx2        = 64       # Number of zones in X2-direction
x2min      = -50.0       # minimum value of X2
x2max      = 50.0       # maximum value of X2
ix2_bc     = periodic   # inner-X2 boundary flag
ox2_bc     = periodic   # outer-X2 boundary flag

nx3        = 128       # Number of zones in X3-direction
x3min      = -100.       # minimum value of X3
x3max      = 100.       # maximum value of X3
ix3_bc     = user       # inner-X3 boundary flag
ox3_bc     = user       # outer-X3 boundary flag


<parthenon/meshblock>
nx1        = 32        # Number of zones in X1-direction
nx2        = 32        # Number of zones in X2-direction
nx3        = 32        # Number of zones in X3-direction

<hydro>
gamma = 1.6666666666666667 # gamma = C_p/C_v
eos = adiabatic
riemann = lhllc
reconstruction = ppm
first_order_flux_correct = true
use_scratch = false
scratch_level = 0 # 0 is actual scratch (tiny); 1 is HBM

He_mass_fraction = 0.25
#dfloor = 14.78021   # Msun kpc^{-3} [== 1e-30 g/cc]
Tfloor = 1.0e6      # K

<units>
code_length_cgs = 3.086e21      # kpc
code_mass_cgs = 1.98841586e+33  # Msun
code_time_cgs = 3.15576e+13     # Myr

<cooling>
enable_cooling = tabular    # tabular
integrator = rk12           # (townsend, rk12)
table_filename = ./inputs/precipitator.cooling
log_temp_col = 0
log_lambda_col = 1
lambda_units_cgs = 1
cfl = 1.0

<precipitator>
hse_profile_filename = ./inputs/profile_tc_tff_3.0.txt
uniform_init = 0
enable_heating = magic   # magic
thermostat_temperature = 1.0e7  # K
thermostat_Kp = 10.0      # time constant (inverse cooling times)
numHist = 64
h_smooth_heatcool_kpc = 5.0

perturb_sin_drho_over_rho = 0.0
perturb_kx = 16
perturb_ky = 16
perturb_kz = 32
perturb_exponent = 1    # P(k) ~ k^{-2}

<precipitator/driving>
#sigma_v = 0
sigma_v = 0.0001   # kpc Myr^{-1}
k_peak = 2
#num_modes = 40
#vertical_driving_only = false
num_modes = 12
vertical_driving_only = true
sol_weight = 1.0
rseed = 42
t_corr = 500.0   # Myr
max_height = 80.0 # kpc
